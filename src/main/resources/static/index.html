<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<title></title>
	<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0">
	<script src="https://cdn.bootcdn.net/ajax/libs/vue/3.2.47/vue.global.min.js"></script>
	<script src="https://cdn.bootcdn.net/ajax/libs/vue-router/4.1.6/vue-router.global.js"></script>
	<script src="https://cdn.bootcdn.net/ajax/libs/vuex/4.1.0/vuex.global.js"></script>
	<script src="https://cdn.bootcdn.net/ajax/libs/axios/1.3.6/axios.js"></script>
	<script src="/lib/common.js"></script>
	<style>

		:root {
            --topColor: white;
            --bottomColor: white;
        }
		body {
			margin: 0;
		}

		html,
		body,
		#app {
			height: 100%;
		}

		#app {
			max-width: 800px;
			border:1px solid black;
			margin:auto;
			position: relative;
		}

		*,
		*::before,
		*::after {
			box-sizing: border-box;
		}

		ul {
			padding: 0;
		}

		li {
			list-style-type: none;
		}

		li:hover {
			background: #efecec;
		}

		button{
			border: 1px solid black;
			border-radius: 5px;
			padding: 2px 8px;
		}

		input{
			border: 1px solid black;
			border-radius: 5px;
			padding: 2px 8px;
		}

		.border-b-1{
			border-bottom: 1px solid black;
		}

		.mode{
			width:100%;
			height:100%;
			position: absolute;
			top:0;
			left:0;
			z-index: 10;
		}
		.mode-body{
			width:800px;
			max-width: 100%;
			height:100%;
			margin: auto;
			background-color: white;
		}
		a{
			color:black !important;
			text-decoration: none;
		}
		.n-active{
			border-bottom: 2px solid black;
		}

		[v-cloak] {
			display: none;
		}

		/* 通用CSS */

		.float-end{
			float: right;
		}

		.text-right{
			text-align: right;
		}
		.text-center{
			text-align: center;
		}

		.w-100{
			width: 100%;
		}

		.h-100{
			height: 100%;
		}

		.p-5{
			padding: 5px;
		}

		.p-10{
			padding: 10px;
		}
		
		.p-t-0{
			padding-top: 0;
		}

		.p-b-5{
			padding-bottom: 5px;
		}

		.p-b-10{
			padding-bottom: 10px;
		}

		.m-0{
			margin: 0;
		}

		.m-10{
			margin: 10px;
		}

		.m-b-0{
			margin-bottom: 0;
		}

		.m-b-2{
			margin-bottom: 2px;
		}

		.m-b-5{
			margin-bottom: 5px;
		}

		.m-b-10{
			margin-bottom: 10px;
		}

		.b-r-5{
			border-radius: 5px;
		}

		.b-1{
			border: 1px solid black;
		}

		/* 指定CSS */

		.message-body{
			border: 1px solid black;
			border-radius: 5px;
			margin: 0px;
			margin-bottom: 0px;
			padding:5px;
		}


		.name-color{
			color: #3c3ce2;
		}

		@media screen and (min-width:700px){
            body{
				padding: 10px;
			}
			#app,.mode-body{
				border-radius: 5px;
				overflow: hidden;
			}
        }

	</style>
</head>
<body>
	<div id="app" v-cloak>
		<router-view></router-view>
	</div>
</body>
<script type="module">
	const routes = [
		{
			path: '/', redirect:"home", component: () => import('./view/index.js'),
			children: [
				{
					path: '/', name:'home', redirect: 'message', component: () => import('./view/home.js'),
					children: [
						{
							path: "/message", name: "message", component: () => import('./view/message.js')
						},
						{
							path: "/more", name: "more", component: () => import('./view/more.js')
						},
						{
							path: "/member", name: "member", component: () => import('./view/member.js')
						},
						{
							path: "/group", name: "group", component: () => import('./view/group.js')
						},
						{
							path: "/me", name: "me", component: () => import('./view/me.js')
						}
					]
				},
				{
					path: "/member-message", name: "member-message", component: () => import('./view/member-message.js')
				},
				{
					path: "/group-message", name: "group-message", component: () => import('./view/group-message.js')
				},
				
			]
		},
		{
			path: "/login", name: "login", component: () => import('./view/login.js')
		},
		{
			path: "/register", name: "register", component: () => import('./view/register.js')
		}
	]

	const router = VueRouter.createRouter({
		history: VueRouter.createWebHashHistory(),
		routes,
	})

	const app = Vue.createApp({})

	let store = Vuex.createStore({
		state: {
			member:null,
			socketLocal: null,
			socketGroup: {},
			socketMember: null,
			groupMap:{},
			groupMessageListMap:{},
			memberMap:{},
			memberMessageListMap:{},
			verifyList:[],
			unReadMessageCount:{}
		}
	})

	router.afterEach((to) => {
		// 路由拦截器
		console.log("你路由了")
	})


	const root = document.documentElement;

	let topColor = localStorage.getItem("--topColor");
	let bottomColor = localStorage.getItem("--bottomColor");
	
	if(topColor){
		root.style.setProperty("--topColor", topColor);
	}else{
		root.style.setProperty("--topColor", "rgb(255, 222, 252)");
	}

	if(bottomColor){
		root.style.setProperty("--bottomColor", bottomColor);
	}else{
		root.style.setProperty("--bottomColor", "rgb(255, 248, 248)");
	}

	app.use(router)
	app.use(store)
	app.mount('#app')
	
</script>

</html>